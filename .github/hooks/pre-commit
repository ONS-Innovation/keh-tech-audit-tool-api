#!/bin/bash
# This script increments the patch version in the .version file before each commit.

version_file="aws_lambda_script/app/.version"

if [ -f "$version_file" ]; then
    # Read the current version
    current_version=$(cat $version_file)

    # Extract major, minor, and patch numbers
    major=$(echo $current_version | cut -d. -f1)
    minor=$(echo $current_version | cut -d. -f2)
    patch=$(echo $current_version | cut -d. -f3)

    # Increment the patch number
    new_patch=$((patch + 1))

    # Create the new version
    new_version="$major.$minor.$new_patch"

    # Update the .version file with the new version
    echo $new_version > $version_file

    # Stage the updated .version file for the commit
    git add $version_file

    echo "Version updated to $new_version"
else
    # If no .version file exists, create it with an initial version of 0.0.1
    echo "0.0.1" > $version_file
    git add $version_file
    echo "Created .version file with version 0.0.1"
fi
